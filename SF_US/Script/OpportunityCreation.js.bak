//USEUNIT AccountCreation_Name
//USEUNIT DataRead


function Create_opportunity(TestCaseID)
{
  //TestCaseID="B04" 
  var LoginDataMap=dataReader("SF_opportunity"); //Sheetname
  var Type=LoginDataMap[TestCaseID]["Type"];
  var GamingClassification=LoginDataMap[TestCaseID]["GamingClassification"];
  var LeadSource=LoginDataMap[TestCaseID]["LeadSource"];
  var MarketSegment=LoginDataMap[TestCaseID]["MarketSegment"];
  var AccountName=LoginDataMap[TestCaseID]["AccountName"];

  Delay(2000);
  Aliases.browser.page__Home.NewOpportunity__button.Click();

  Delay(2000);
  var randomNumber = Math.floor(Math.random() * 1000) + 1;
  var AccountName1  = AccountName + "-" + "Test" + randomNumber  ;
  Project.Variables.OpportunityName = AccountName1 ;
  
  Log.Message("AccountName");
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.OpportunityName__field.SetText(AccountName1);
  
  Log.Message("GamingClassification");
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.GamingClassification__list.Click();
  Delay(3000);
    Aliases.browser.Page__Opportunity.OpportunityName__Panel.GamingClassification__list.Keys(GamingClassification);
    KeyboardOperations("Enter",1)
 // Aliases.browser.Page__Opportunity.OpportunityName__Panel.GamingClassification__list.FindElement("//li[.='"+GamingClassification+"']").Click();
 
  
  Delay(2000);
  Log.Message("Type");
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.Type__list.Click();
  Delay(2000);
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.Type__list.Keys(Type);
  KeyboardOperations("Enter",1)
 
  
 Delay(1000);
  Log.Message("MarketSegment");
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.MarketSegment__list.Click();
  LLPlayer.MouseMove(100, 100,100);
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.MarketSegment__list.Keys(MarketSegment);
  KeyboardOperations("Enter",2)
  //ListSelection (MarketSegment) //"Class III"
  
  Delay(1000);
  Log.Message("LeadSource");
  Aliases.browser.Page__Opportunity.OpportunityName__Panel.LeadSource__list.Click();
   Aliases.browser.Page__Opportunity.OpportunityName__Panel.LeadSource__list.Keys(LeadSource);
    KeyboardOperations("Enter",6)
  //ListSelection (LeadSource) //"Customer"
  Aliases.browser.page__Home.RFCSave_button.Click();
  Delay(8000);
}


function Opportunity_Success_Validation()
{
  
  aqObject.CheckProperty(Aliases.browser.page__login.AccountCreation__toast, "Enabled", cmpEqual, true);
}


 

function OpenAccount_Page()
{
  Delay(2000);
  
   Aliases.browser.page__Home.GlobalAll__tab.Click();
 
  Delay(4000);
  
  Aliases.browser.page__Home.GlobalAll__tab.Keys("[Down][Enter]");
  
  Delay(2000);
  
  Aliases.browser.page__Home.GlobalSearch__field.Keys(Project.Variables.ParentAccount);
 

   Aliases.browser.page__Home.GlobalSearch__field.Keys("[Enter]");
 
   Delay(4000);
  
   Aliases.browser.page__Home.NewOpportunity__tab.Click();
   Delay(2000);
 
 
  //Aliases.browser.Page__PreAccountApproval.Home__Panel.UserLogedIn__Panel.SelectAccount__Tab.Click();
  
  
  Delay(2000);
}