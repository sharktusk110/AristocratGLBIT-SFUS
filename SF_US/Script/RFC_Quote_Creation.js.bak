//USEUNIT DataRead



function Openconfigopportunity()

{
  Log.Message("[Test]: opening created opportunity from B02 ")
  Log.Message("Clicks the 'GlobalSearch_Tab' control")
  Aliases.browser.Page__PreAccountApproval.Home__Panel.UserLogedIn__Panel.GlobalAccount__Tab.Click();
  Delay(2000);
   
  NameMapping.Sys.browser.pageHomeSearch.textnodeOpportunities2.Click();
  Delay(2000);
  
  Log.Message("Sets the text Project.Variables.OpportunityName in the 'GlobalSearch_Bar' text editor")
  Aliases.browser.Page__PreAccountApproval.Home__Panel.headerOneheader2.GlobalSearch__Field.Keys(Project.Variables.OpportunityName);
  
  Log.Message(" Delays the test execution for the specified time period.")  
   Delay(2000);
  
  Aliases.browser.Page__PreAccountApproval.Home__Panel.headerOneheader2.GlobalSearch__Field.Keys("[Enter]");
 
  Log.Message(" Delays the test execution for the specified time period.")
  Delay(4000); 
  
  
  
  Aliases.browser.Page__PostAccountApproval.NewOpportunity__Tab.Click();
  Delay(6000); 
 
 }
 

 

function Create_RFC_Quote()
{
  Log.Message("[Test]: Creating RFC Quote" )
  Aliases.browser.Page__RFCQuote.RFCQuote__Button.Click();
  Delay(2000);
  
  Log.Message("[validation]: verifying syncNow checkbox is displaying")
  var syncNow = NameMapping.Sys.browser.pageHomeSearch.checkboxSyncNow
  aqObject.CheckProperty(syncNow, "Enabled", cmpEqual, true);
  Delay(2000);
 
  Aliases.browser.Page__RFCQuote.RFCSave_Button.ClickButton();
  Delay(2000);
  
  //Validation needs to be put in place inorder to validate whether RFC getting created successfully .
  Log.Message("alidation needs to be put in place inorder to validate whether RFC getting created successfully .");
  
  aqObject.CheckProperty(Aliases.browser.Page__Login.ToastSuccess__Label, "Enabled", cmpEqual, true);
  Log.Message("[RFC Quote]:  "+ Aliases.browser.Page__Login.ToastSuccess__Label.contentText)
  Delay(6000);
  
  Aliases.browser.Page__PreAccountApproval.Home__Panel.UserLogedIn__Panel.GlobalAccount__Tab.Click();
  Delay(2000);
  
  Aliases.browser.Page__RFCQuote.Quote__Button.Click();
  Delay(2000);
 
  Log.Message("Sets the text Project.Variables.OpportunityName in the 'GlobalSearch_Bar' text editor")
  
  Aliases.browser.Page__PreAccountApproval.Home__Panel.headerOneheader2.GlobalSearch__Field.Keys(Project.Variables.OpportunityName);
  
  Log.Message(" Delays the test execution for the specified time period.")  
   Delay(3000);
  KeyboardOperations("Down",1)
  Delay(1000)
  KeyboardOperations("Enter",1)
  Delay(1000);
  //Aliases.browser.Page__PreAccountApproval.Home__Panel.headerOneheader2.GlobalSearch__Field.Keys("[Enter]");
 
  Log.Message(" Delays the test execution for the specified time period.")
  Delay(6000);
   
  
 // Aliases.browser.Page__PostAccountApproval.NewOpportunity__Tab.Click();

}




function RFC_Quote_Update()
{
  
   
   Aliases.browser.Page__RFCQuote.PaymentTerms__Panel.PaymentTerms__Button.Click();
   Delay(2000);
   
   let textNode = Aliases.browser.Page__RFCQuote.PaymentTerms__Panel;
   
   Aliases.browser.Page__RFCQuote.PaymentTerms__Panel.PaymentTerms__Tab.Click();
   
  //Clicks the 'Monthly12Payments__Tab' control.
  
  var LoginDataMap=dataReader("SF_opportunity"); //Sheetname
  var EqualMonthlyPayments=LoginDataMap["B03"]["PaymentTerms"];
  var LeaseTerm=LoginDataMap["B03"]["LeaseTerm"];
  
  Delay(2000);
  Aliases.browser.Page__RFCQuote.PaymentTerms__Panel.FindElement("//span[@title='"+EqualMonthlyPayments+"']").Click();
  // Monthly12Payments__Tab.Click();
  Delay(2000);
  
  //Clicks the 'LeaseTerm__Tab' button.
  Aliases.browser.Page__RFCQuote.LeaseTerm__Panel.LeaseTerm__Tab.Click();
  Delay(2000);
 
 // textNode.LeaseTerm__Panel.buttonLeaseTerm2.Click();
   Delay(2000);
   Aliases.browser.Page__RFCQuote.LeaseTerm__Panel.LeaseTerm__Tab.FindElement("//span[@title='"+LeaseTerm+"']").Click();
  
  //Clicks the 'TermReason__Tab' control.
  Aliases.browser.Page__RFCQuote.LeaseTerm__Panel.TermReason__Tab.Click();
  Delay(2000);
  
  //Enters Project.Variables.OpportunityName in the 'TermReason__Tab' object.
  Aliases.browser.Page__RFCQuote.LeaseTerm__Panel.TermReason__Tab.Keys(Project.Variables.OpportunityName);
  Delay(2000);
  
  Aliases.browser.Page__AccountCreation.Save__button.ClickButton();
 
  
  Log.Message("Check point verified that Finance Charge per EGM is eqaul to $1250 ")
 // aqObject.CheckProperty(Aliases.browser.Page__PostAccountApproval.Detail__Tab.FinanceCharge__Label, "contentText", cmpEqual, "USD 1,250.00");
  
}


