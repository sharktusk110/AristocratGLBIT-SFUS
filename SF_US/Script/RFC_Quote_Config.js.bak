//USEUNIT DataRead


function Verify_Existing_LineItem(Flag)
{ 
  
  Aliases.browser.page__Home.QuoteAddEditLineItems__tab.Click();
  Delay(2000);
  
  Log.Message(" validetion checked that opened opprotunity is alredy configured")
  aqObject.CheckProperty(Aliases.browser.Page__EditLineItem.GrantTotalAmount__label, "Enabled", cmpEqual, true);
  var GrantTotalAmount  = Aliases.browser.Page__EditLineItem.GrantTotalAmount__label.contentText
  
  if (Flag === "After") { Project.Variables.afterGrandTotalEGM = GrantTotalAmount; } 
  else if (Flag === "Before") { Project.Variables.afterGrandTotalEGM = GrantTotalAmount; }
 }
 
         // CompareValue("abcxyz","abc")



 
 
 
 
 function Verify_upright_Required_Field()
 {
  Delay(2000);
  
    var CasesWS=dataReader("SF_opportunity"); //Sheetname
    //var Quantity=CasesWS["B03"]["Quantity"];
    var ConversionQuantity=CasesWS["B03"]["ConversionQuantity"];
  
  //Clicks the 'ConfigTool__Tab' control.
  Aliases.browser.Page__RFCQuote.ConfigTool__Tab.Click();
  Delay(2000);
  
   // Aliases.browser.Page__RFCQuote.Page__Configu.sectionConfigure2.Qnty__Tab.SetText(Quantity);
    
    //var quantity= Aliases.browser.Page__RFCQuote.Page__Configu.sectionConfigure2.Qnty__Tab.contentText;
    //Project.Variables.EGMCOUNT_Before=quantity
    
    
    Aliases.browser.page__EditLineItem.Qnty__tab.SetText(ConversionQuantity);
    Delay(2000);
  
    
  //Aliases.browser.Page__RFCQuote.buttonSave.ClickButton();
  //Delay(6000);
 
 Log.Message("checking required field is enabled for Freight")
  aqObject.CheckProperty(Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.FreightRequired__tab, "Enabled", cmpEqual, true);
  Delay(2000);
  
  Log.Message("checking required field is enabled for Promotions")
  aqObject.CheckProperty(Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.PromotionRequired__tab, "Enabled", cmpEqual, true);
  Delay(2000);
  
  Log.Message("checking required field is enabled for License")
  aqObject.CheckProperty(Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.LicenceRequired__tab, "Enabled", cmpEqual, true);
  Delay(2000);
  
 
  Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.Frieght__tab.Click();
  Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.Frieght__tab.Keys("[Down][Down][Enter]");
  Delay(2000);

  Aliases.browser.page__EditLineItem.Configure__Panel.License__tab.Click();
  Aliases.browser.page__EditLineItem.Configure__Panel.License__tab.Keys("[Down][Down][Enter]")
  Delay(3000);
  
  
  Aliases.browser.page__EditLineItem.Configure__Panel.Promotion__Button.Click();
  Delay(2000);
   KeyboardOperations("Down",2)
   KeyboardOperations("Enter",1) 
 
  Aliases.browser.page__RFCQuote.RfcQSave__button.ClickButton();
  Delay(12000);
  
  Log.Message("Account has been created seccessfull massege")
  //aqObject.CheckProperty(Aliases.browser.Page__AccountCreation.AccountCreation__Toast, "Enabled", cmpEqual, true);
}




function Conver_Config()
{
  Delay(2000);
  NameMapping.Sys.browser.pageCasinoRoyaleAccountSalesforc.ConverTool__Tab.Click();
  Delay(2000);
  
    var CasesWS=dataReader("SF_opportunity"); //Sheetname
    var EGMQuantity=CasesWS["B03"]["EGMQuantity"];
    var ConversionQuantity=CasesWS["B03"]["ConversionQuantity"];
  
  Aliases.browser.page__EditLineItem.Qnty__tab.SetText(EGMQuantity);
  Delay(2000);
  
  Aliases.browser.page__RFCQuote.RfcQSave__button.ClickButton();
  Delay(2000);
 
  Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.Frieght__tab.Click();
  Aliases.browser.page__RFCQuote.Page__Configu.ConfigureEditLineItem__panel.Frieght__tab.Keys("[Down][Down][Enter]");
  Delay(2000);
  
   Aliases.browser.page__EditLineItem.Configure__Panel.Promotion__Button.Click();
  Delay(2000);
   KeyboardOperations("Down",2)
   KeyboardOperations("Enter",1) 
  

  //Aliases.browser.Page__EditLineItem.sectionConfigure.License__Tab.Click();
  //Delay(2000);
  
  Aliases.browser.page__RFCQuote.RfcQSave__button.ClickButton();
  Delay(8000);
  
  Log.Message(" Toaster validation checked that conversion sale  is updated successfully")
  //aqObject.CheckProperty(Aliases.browser.Page__AccountCreation.AccountCreation__Toast, "contentText", cmpEqual, "Success notification.\nProduct Configuration saved.\nPress Control + F6 to navigate to the next toast notification or focusable region.\nClose");
  //Delay(2000);
 
  Log.Message(" validetion checked that updated quantity is reflecting in quantity Box")
  aqObject.CheckProperty(NameMapping.Sys.browser.pageCasinoRoyaleAccountSalesforc.Qnty__Box, "Enabled", cmpEqual, true);
  Delay(2000);
  
  
  Aliases.browser.page__RFCQuote.CloseQ__button.ClickButton();
  Delay(2000);
  
  Log.Message("Total EGM count is verified on Quote Page")
  aqObject.CheckProperty(Aliases.browser.page__RFCQuote.EgmCount__text, "Enabled", cmpEqual, true);
  Delay(2000);
   
  Log.Message("Total Conversion line item count is verified on Quote Page")
  aqObject.CheckProperty(Aliases.browser.page__RFCQuote.ConverLineItemCount__label, "Enabled", cmpEqual, true);
  Delay(2000);
  var ConversionLIneItemCount= Aliases.browser.page__RFCQuote.ConverLineItemCount__label.contentText

    var EGMQ1 = Aliases.browser.page__RFCQuote.EGMQuantity__label.contentText
    var EGMQ = parseInt(EGMQuantity) + parseInt(ConversionQuantity);
 
    EGMCountValidation()
  
  // CompareValue(parseInt(ConversionLIneItemCount),parseInt(ConversionQuantity))
  
  }
  
  
   function EGMCountValidation()
   {
    var CasesWS=dataReader("SF_opportunity"); //Sheetname
    var EGMQuantity=CasesWS["B03"]["EGMQuantity"];
    var ConversionQuantity=CasesWS["B03"]["ConversionQuantity"];
  
   var ConversionLIneItemCount= Aliases.browser.page__RFCQuote.ConverLineItemCount__label.contentText

    var EGMQ1 = Aliases.browser.page__RFCQuote.EGMQuantity__label.contentText
    var EGMQ = parseInt(EGMQuantity) + parseInt(ConversionQuantity);
     
     if (parseInt(EGMQ)  ===  parseInt(EGMQ1))
     {
       Log.Message("Value of Conversion line item is updated successfuly in RFC quote")
     
     }
     else {
           Log.error("Not executed")  
     
     }
 
   }
  
  
  
  
  
  function validate_oppor()
  {
  
  
  Aliases.browser.page__Home.GlobalSearch__field.SetText(Project.Variables.OpportunityName);
  Delay(2000);
   
  Aliases.browser.page__Home.GlobalSearch__field.Keys("[Enter]");
  Delay(2000);
  
  Aliases.browser.page__Home.NewOpportunity__tab.Click();
  Delay(2000);
 
  Log.Message("Total EGM count is verified on Opportunity Page")
  aqObject.CheckProperty(NameMapping.Sys.browser.pageCasinoRoyaleAccountSalesforc.panelEgmCount, "Enabled", cmpEqual, true);
  Delay(2000);
 
   Log.Message("Total Conversion line item count is verified on Opportunity Page")
  aqObject.CheckProperty(Aliases.browser.Page__PostAccountApproval.ConversionLineItemCount__text, "Enabled", cmpEqual, true);
  Delay(2000);
  
  Log.Message("Payment Term is verified on Opportunity Page")
  aqObject.CheckProperty(Aliases.browser.page__Account.Detail__tab.Paymentterm12EMP__text, "contentText", cmpEqual, "12 Equal Monthly Payments");
  Delay(2000);

  Aliases.browser.page__Home.EditLineItem__tab.ClickButton();
  Delay(2000);
  
  Aliases.browser.Page__RFCQuote.Click__Panel.Opport__Click.Click();
  Delay(2000);
  
  Aliases.browser.page__EditLineItem.Close__button.ClickButton();
}




function OpenRFC_Quote()
{
  Aliases.browser.page__Home.GlobalAll__tab.Click();
  Delay(2000);
  
  Aliases.browser.page__Home.GlobalAll__tab.Keys("[Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Down][Enter]");
  Delay(3000);
  
  Log.Message("Sets the text Project.Variables.OpportunityName in the 'GlobalSearch_Bar' text editor")
  Aliases.browser.page__Home.GlobalSearch__field.SetText(Project.Variables.OpportunityName);
  Delay(2000);
  
   Aliases.browser.page__Home.GlobalSearch__field.Keys("[Enter]");
  //Aliases.browser.Page__PreAccountApproval.Home__Panel.UserLogedIn__Panel.SelectAccount__Tab.Click();
  //Delay(2000);
  
  Aliases.browser.page__Home.NewOpportunity__tab.Click();
  Delay(2000);
}